---
layout: post
title: "[git] タグ打ちするときーーー"
date: 2014-03-03T21:10:00-08:00
comments: false
categories:
 - git
---


<div class='post'>
タグ打ちするときの便利コマンド。
<br />
<br />というか僕がよく使うことになる予定のコマンドのメモ。
<br />
<br />
<h4>今のgitの運用
</h4>
<ul>
<li>bug対はmaster
</li>
<li>ちょい修正もmaster
</li>
<li>大き目機能改善・機能開発は都度新しいbranch切る
</li>
</ul>1人でテキトウに作ってるのでなんとなくな感じです。
<br />
<br />
<h4>大体やりたいこと
</h4>
<ul>
<li>releaseするときはtagを打ちたい
</li>
<li>既存で打ってあるtagの修正、ファイル追加・削除をしたい
</li>
<li>上記を便利コマンドを使ってやりたい
</li>
<li>ついでにgitを覚えたい
</li>
</ul>きっとこんなところ。
<br />
<br />そして、色々調べてみてわかったこと。
<br />gitのtagは、ファイルに打つんじゃなくて、commitに対して打つ、ということ。
<br />まぁそれならそれでそういう方針にしようかな。
<br />
<br />
<h4>大体やりたいこと(修正版)
</h4>
<ul>
<li>releaseするときはtagを打ちたい
</li>
<li>既存で打ってあるtagの修正(違うcommitに対して打ちたい)
</li>
<li>上記を便利コマンドを使ってやりたい
</li>
<li>ついでにgitを覚えたい
</li>
</ul>くらいかなぁ。 
<br />では、以下で実際使いそうなコマンドたちを羅列。 
<br />
<br />
<h4>各tagのアノテーションを確認する
</h4>このタグなんのタグ？ってときに。
<br />
<pre class="prettyprint">
<span style="font-size: small;">$ git tag -n
</span>
</pre>
<br />
<h4>既存tagのアノテーションを編集する
</h4>tagnameをtagnameで上書きするみたい。
<br />
<pre class="prettyprint">
<span style="font-size: small;">$ git tag tagname tagname -f -m *annotation*
</span>
</pre>
<br />
<h4>任意のtagとHEADのdiffを取る
</h4>
<pre class="prettyprint">
<span style="font-size: small;">$ git diff tagname HEAD
</span>
</pre>
<br />
<h4>任意のtagとHEADのざっくりdiffを取る
</h4>
<pre class="prettyprint">
<span style="font-size: small;">$ git diff --stat --color tagname HEAD
</span>
</pre>
<br />
<h4>HEADに、任意のtagを打つ
</h4>
<pre class="prettyprint">
<span style="font-size: small;">$ git tag -a tagname
<br />$ git tag -a tagname -m "annotation"
<br />
</span>
</pre>
<br />
<h4>任意のcommitに、任意のtagを打つ
</h4>
<pre class="prettyprint">
<span style="font-size: small;">$ git tag tagname commit
</span>
</pre>
<br />
<h4>各commitで変更されたファイルを確認する
</h4>
<pre class="prettyprint">
<span style="font-size: small;">$ git log --stat
<br />$ git log --numstat
<br />$ git log --numstate
<br />$ git log --name-status
<br />$ git log --name-only
<br />
</span>
</pre>
<br />
<h4>各tagに対応するcommitを確認する
</h4>
<pre class="prettyprint">
<span style="font-size: small;">$ git show tagname
<br />
</span>
</pre>
<h4>全体的なフロー
</h4>今のところ2パターン。  
<br />
<br />
<h4>パターン１：
</h4>HEADにこのtag打っちゃえ～！！やっほ～！！！のパターン。 
<br />
<ul>
<li>HEADに、任意のtagを打つ
</li>
</ul>をやればOK。  
<br />
<h4>パターン２：
</h4>あー、tag間違って打った・・・どのcommitに打ちなおすんだっけ・・・。のパターン。 
<br />
<ul>
<li>各tagのアノテーションを確認する、でアノテーション見て修正するtagを決める
</li>
<li>任意のtagとcommitのざっくりdiffを取る ＆ 各commitで変更されたファイルを確認して、正しいcommitを探す
</li>
<li>任意のcommitに、任意のtagを打つ
</li>
</ul>これできっといけるはず。 
</div>
