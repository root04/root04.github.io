---
layout: post
title: "apt-mirror and postmirror.sh"
date: 2012-06-11T09:23:00-07:00
comments: false
---

<div class='post'>
<br />I wrote about building my own repository before.<br /><br /><a href="http://unknown-xengineer.blogspot.jp/2011/12/local-repository-for-ubuntu.html">blog1</a><br /><br /><a href="http://unknown-xengineer.blogspot.jp/2011/12/local-repository-for-ubuntu.html">blog2</a><br /><br /><a href="http://unknown-xengineer.blogspot.jp/2011/12/postmirrorsh-postmirrorsh.html">blog3</a><br /><br />I realized that I hadn't concluded anything, so I decided to write again.<br /><br />I defined the specification as follows.<br /><br />- mirror repository<br />- take a backup with generation control<br /><br />############# config ##################<br />#<br /># set base_path &nbsp; &nbsp;/var/spool/apt-mirror<br />#<br /># set mirror_path &nbsp;$base_path/mirror<br /># set skel_path &nbsp; &nbsp;$base_path/skel<br /># set var_path &nbsp; &nbsp; $base_path/var<br /># set cleanscript $var_path/clean.sh<br /># set defaultarch &nbsp;&lt;running host architecture&gt;<br /># set postmirror_script $var_path/postmirror.sh<br /># set run_postmirror 0<br /><br />set base_path &nbsp; &nbsp;/mnt/external/repository_tmp<br />set mirror_path &nbsp;$base_path/mirror<br />set skel_path &nbsp; &nbsp;$base_path/skel<br />set var_path &nbsp; &nbsp; $base_path/var<br />set cleanscript $var_path/clean.sh<br />set defaultarch amd64<br />set postmirror_script /etc/apt/postmirror.sh<br />set run_postmirror 1<br />set nthreads &nbsp; &nbsp; 10<br />set _tilde 0<br />#<br />############# end config ##############<br /><br />deb-amd64 http://ftp.riken.go.jp/Linux/ubuntu precise main main/debian-installer restricted restricted/debian-installer universe multiverse<br />deb-amd64 http://ftp.riken.go.jp/Linux/ubuntu precise-security main restricted universe multiverse<br />deb-amd64 http://ftp.riken.go.jp/Linux/ubuntu precise-updates main restricted universe multiverse<br /><br />clean http://ftp.riken.go.jp/Linux/ubuntu<br />#clean http://jp.archive.ubuntu.com/ubuntu<br /><div><br /></div></div>
